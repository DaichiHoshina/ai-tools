---
name: architecture-review
description: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€DDDã€ä¾å­˜é–¢ä¿‚ã®è¦³ç‚¹ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼
requires-guidelines:
  - common
---

# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¬ãƒ“ãƒ¥ãƒ¼

## ä½¿ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°

- **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ï¼ˆè¨­è¨ˆè¦³ç‚¹ã®ç¢ºèªï¼‰**
- **æ–°æ©Ÿèƒ½è¨­è¨ˆæ™‚ï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é©åˆæ€§ï¼‰**
- **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ï¼ˆæ§‹é€ æ”¹å–„ï¼‰**

## ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

### ğŸ”´ Criticalï¼ˆä¿®æ­£å¿…é ˆï¼‰

#### 1. ä¾å­˜é–¢ä¿‚ã®é€†è»¢
```
// âŒ å±é™º: Domain ãŒ Infrastructure ã«ä¾å­˜
domain/
  user.go
    import "infrastructure/database"  â† ç¦æ­¢ï¼

// âœ… æ­£ã—ã„: Infrastructure ãŒ Domain ã«ä¾å­˜
domain/
  user.go
  repository.go  â† ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
infrastructure/
  user_repository.go
    import "domain"  â† OK
```

#### 2. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®é…ç½®é•å
```typescript
// âŒ å±é™º: Controller ã«ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
class UserController {
  async create(req) {
    // è¤‡é›‘ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ãŒã“ã“ã«ã‚ã‚‹
    if (user.age >= 18 && user.status === 'verified') { ... }
  }
}

// âœ… æ­£ã—ã„: UseCase/Domain ã«é…ç½®
class CreateUserUseCase {
  execute(input: CreateUserInput) {
    const user = User.create(input);
    user.verify();  // ãƒ­ã‚¸ãƒƒã‚¯ã¯Domainã«
  }
}
```

#### 3. å¾ªç’°ä¾å­˜
```
// âŒ å±é™º
moduleA â†’ moduleB â†’ moduleC â†’ moduleA

// âœ… è§£æ±ºç­–
- å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŠ½å‡º
- ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã§ç–çµåˆåŒ–
- ä¾å­˜æ–¹å‘ã‚’æ•´ç†
```

### ğŸŸ¡ Warningï¼ˆè¦æ”¹å–„ï¼‰

#### 1. Fat Controller / Fat Service
```typescript
// âš ï¸ 1ãƒ•ã‚¡ã‚¤ãƒ«500è¡Œè¶…ãˆã€è¤‡æ•°è²¬å‹™
class UserService {
  createUser() { ... }
  sendEmail() { ... }
  generateReport() { ... }
  calculateTax() { ... }
}

// âœ… è²¬å‹™åˆ†é›¢
class CreateUserUseCase { ... }
class EmailService { ... }
class ReportGenerator { ... }
```

#### 2. Domain Service ã®ä¹±ç”¨
```go
// âš ï¸ Domain Service ã«å…¨ãƒ­ã‚¸ãƒƒã‚¯
type UserDomainService struct {}
func (s *UserDomainService) CalculateDiscount(user *User) { ... }

// âœ… Entity ã«ãƒ­ã‚¸ãƒƒã‚¯é…ç½®
type User struct { ... }
func (u *User) CalculateDiscount() Discount { ... }
```

#### 3. ä¸é©åˆ‡ãªãƒ¬ã‚¤ãƒ¤ãƒ¼å‚ç…§
```
// âš ï¸ UseCase ãŒ Presentation å±¤ã®å‹ã‚’ä½¿ç”¨
usecase/
  create_user.go
    import "presentation/dto"  â† æ”¹å–„æ¨å¥¨

// âœ… UseCase å°‚ç”¨ã® Input/Output
usecase/
  create_user.go
  create_user_input.go
  create_user_output.go
```

## ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆãƒã‚§ãƒƒã‚¯

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
ä¾å­˜æ–¹å‘: å¤–å´ â†’ å†…å´ã®ã¿

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Infrastructure (DB, API, Framework)â”‚ â† æœ€å¤–éƒ¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Interface (Controller, Presenter)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Application (UseCase, Service)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Domain (Entity, ValueObject, Repo) â”‚ â† æœ€å†…éƒ¨ï¼ˆä¾å­˜ãªã—ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DDD ãƒ‘ã‚¿ãƒ¼ãƒ³

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | è²¬å‹™ | ãƒã‚§ãƒƒã‚¯ |
|---------|------|---------|
| Entity | IDè­˜åˆ¥ã€ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã€ãƒ­ã‚¸ãƒƒã‚¯å†…åŒ… | [ ] |
| Value Object | ä¸å¤‰ã€å€¤æ¯”è¼ƒã€å‰¯ä½œç”¨ãªã— | [ ] |
| Repository | æ°¸ç¶šåŒ–æŠ½è±¡ï¼ˆIF ã¯ Domainã€å®Ÿè£…ã¯ Infraï¼‰ | [ ] |
| Domain Event | éå»å½¢å‘½åã€ç–çµåˆ | [ ] |

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ä¾å­˜é–¢ä¿‚
- [ ] Domain ã¯å¤–éƒ¨ä¾å­˜ãŒãªã„ã‹
- [ ] å¾ªç’°ä¾å­˜ãŒãªã„ã‹
- [ ] ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯é©åˆ‡ãªå±¤ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹

### è²¬å‹™åˆ†é›¢
- [ ] 1ã‚¯ãƒ©ã‚¹/1ãƒ•ã‚¡ã‚¤ãƒ«ãŒå˜ä¸€è²¬å‹™ã‹
- [ ] ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒ Domain/UseCase ã«ã‚ã‚‹ã‹
- [ ] Controller ã¯è–„ã„ã‹ï¼ˆå…¥åŠ›å¤‰æ›ãƒ»UseCaseå‘¼ã³å‡ºã—ãƒ»å‡ºåŠ›å¤‰æ›ã®ã¿ï¼‰

### DDD
- [ ] Entity ã«ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚ã‚‹ã‹
- [ ] Value Object ã¯ä¸å¤‰ã‹
- [ ] Repository IF ã¯ Domain ã«ã‚ã‚‹ã‹

## å‡ºåŠ›å½¢å¼

ğŸ”´ **Critical**: `ãƒ•ã‚¡ã‚¤ãƒ«:è¡Œ` - ä¾å­˜é•å/ãƒ­ã‚¸ãƒƒã‚¯é…ç½®é•å - ä¿®æ­£æ¡ˆ
ğŸŸ¡ **Warning**: `ãƒ•ã‚¡ã‚¤ãƒ«:è¡Œ` - è¨­è¨ˆæ”¹å–„æ¨å¥¨ - ãƒªãƒ•ã‚¡ã‚¯ã‚¿æ¡ˆ
ğŸ“Š **Summary**: Critical Xä»¶ / Warning Yä»¶

## é–¢é€£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½å‰ã«ä»¥ä¸‹ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’å‚ç…§:
- `~/.claude/guidelines/common/code-quality-design.md`

## å¤–éƒ¨çŸ¥è­˜ãƒ™ãƒ¼ã‚¹

æœ€æ–°ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ç¢ºèªã«ã¯ context7 ã‚’æ´»ç”¨:
- DDDï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼‰å…¬å¼è³‡æ–™
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- SOLIDåŸå‰‡

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æƒ…å ±ã‚’ç¢ºèª:
- serena memory ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆãƒ»è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å–å¾—
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¨™æº–çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’å„ªå…ˆ
- æ—¢å­˜ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã®ä¸€è²«æ€§ã‚’ç¢ºèª
