# 要件定義ガイドライン

> **目的**: PRD作成、ユーザーストーリー定義、要件検証のベストプラクティス

---

## PRD構造

| セクション | 内容 |
|-----------|------|
| **Executive Summary** | 問題定義、解決策概要、KPI（1ページ） |
| **Detailed Requirements** | 機能要件（FR-XXX）、非機能要件（NFR-XXX）、制約条件 |
| **Technical Architecture** | システム構成図、データフロー、技術スタック選定理由 |
| **Implementation Plan** | フェーズ分割、依存関係、リスクと対策 |

---

## 要件ID体系

| プレフィックス | 用途 | 例 |
|--------------|------|-----|
| FR | 機能要件 | FR-001: ユーザー登録 |
| NFR | 非機能要件 | NFR-001: 応答時間 < 200ms |
| BR | ビジネスルール | BR-001: 割引計算ロジック |
| UC | ユースケース | UC-001: 商品購入フロー |
| US | ユーザーストーリー | US-001: ログイン機能 |

---

## ユーザーストーリー形式

```
As a [ユーザーロール]
I want [達成したい目標]
So that [得られる価値]

Scenario: [シナリオ名]
Given [前提条件] When [アクション] Then [期待結果]
```

---

## 品質基準

### INVEST（ユーザーストーリー用）

| 項目 | 説明 |
|------|------|
| **I**ndependent | 独立して実装可能 |
| **N**egotiable | 詳細は交渉可能 |
| **V**aluable | ユーザー/ビジネス価値がある |
| **E**stimable | 見積もり可能 |
| **S**mall | 1スプリントで完了可能 |
| **T**estable | テスト可能 |

### SMART（要件用）

| 項目 | 説明 | 例 |
|------|------|-----|
| **S**pecific | 具体的 | 「高速」→「200ms以内」 |
| **M**easurable | 測定可能 | 数値目標を明記 |
| **A**chievable | 達成可能 | 技術的に実現可能 |
| **R**elevant | 関連性 | ビジネス目標と紐づく |
| **T**ime-bound | 期限付き | フェーズ指定 |

---

## 禁止表現

| ❌ 禁止 | ✅ 代替 |
|--------|--------|
| 高速に | 95%ile 200ms以内 |
| 適切に | 具体的な条件を記述 |
| など | すべて列挙 |
| 必要に応じて | 条件を明記 |
| ユーザーフレンドリー | WCAG 2.1 AA準拠 |
| セキュア | OWASP Top 10対策済み |

---

## 検証観点

| 観点 | チェック項目 |
|------|-------------|
| **完全性** | 全ユーザーロール定義、正常系・異常系・境界条件、非機能要件（性能/セキュリティ/可用性） |
| **一貫性** | 用語統一（ユビキタス言語）、要件間の矛盾なし、優先度の整合性 |
| **検証可能性** | 全要件にテスト可能な受け入れ基準、数値目標が具体的、曖昧表現なし |
| **トレーサビリティ** | 要件ID付与、ビジネス目標との紐付け、依存関係の明記 |

---

## 思考フレームワーク

### MECE

要件分類が「漏れなく・重複なく」になっているか検証

### 5W2H

| 項目 | 質問 |
|------|------|
| Who | 誰が使う？ |
| What | 何をする？ |
| When | いつ使う？ |
| Where | どこで使う？ |
| Why | なぜ必要？ |
| How | どう実現？ |
| How much | どのくらい？ |

### 反証思考

- 本当に必要か？
- 逆のケースは？
- 極端なケースは？
- 悪意のあるユーザーなら？

### ステークホルダー視点

| 立場 | 検証ポイント |
|------|-------------|
| エンドユーザー | 使いやすさ、価値 |
| 管理者 | 運用性、管理機能 |
| 開発者 | 実装可能性、保守性 |
| 運用者 | 監視、障害対応 |
| セキュリティ | 脅威対策、認証認可 |
| ビジネス | ROI、KPI達成 |

---

## チェックリスト

- [ ] すべての要件にID付与（FR/NFR/BR/UC/US）
- [ ] INVEST原則でユーザーストーリー検証
- [ ] SMART基準で要件を具体化
- [ ] 禁止表現を使わず数値目標を明記
- [ ] 5W2Hで網羅性を確認
- [ ] ステークホルダー視点で検証
- [ ] トレーサビリティ確保（要件→ビジネス目標）

---

## 参考資料

- PRP Agentic Engineering（/wirasm/prps-agentic-eng）
- Cursor AI PRD Workflow（/nurettincoban/cursor-ai-prd-workflow）
- IEEE 830 SRS標準
- ユーザーストーリーマッピング
