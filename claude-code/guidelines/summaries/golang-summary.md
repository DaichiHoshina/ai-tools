# Go ガイドライン（サマリー版）

## バージョン情報

| 項目 | バージョン |
|------|-----------|
| **最新安定版** | Go 1.26 |
| **ジェネリクス** | Go 1.18以降 |

## 基本原則

| 原則 | 説明 |
|------|------|
| **シンプル** | 複雑な抽象化を避ける |
| **明示的** | 暗黙の動作を避ける |
| **標準ライブラリ優先** | 外部依存を最小限に |

## 型安全性

| NG | OK |
|----|----|
| `func Process(data interface{}) {}` | `func Process[T any](data T) {}` |
| interface{}の多用 | `any` または型パラメータ使用（1.18+） |

## エラーハンドリング

```go
// ✅ 推奨パターン
if err != nil {
    return fmt.Errorf("context: %w", err)
}
```

| 項目 | 推奨 |
|------|------|
| エラーチェック | 必ず実施 |
| ラップ | `%w` でエラーラップ |
| カスタムエラー | `errors.New()` または `fmt.Errorf()` |

## 命名規則

| 種類 | 規則 | 例 |
|------|------|-----|
| パッケージ名 | 小文字・短く・明確 | `http`, `json` |
| エクスポート | 大文字開始 | `ReadFile` |
| 非エクスポート | 小文字開始 | `readFile` |
| インターフェース | -er 接尾辞 | `Reader`, `Writer` |

## 古いパターン検出（レビュー/実装時）

go.modの`go`ディレクティブでバージョン確認後、以下を指摘する。

### 必ず指摘

| ❌ 古い | ✅ モダン | Since |
|---------|----------|-------|
| `ioutil.ReadAll` 等 | `io.ReadAll`, `os.ReadFile` 等 | 1.16 |
| `interface{}` | `any` | 1.18 |

### 積極的に指摘

| ❌ 古い | ✅ モダン | Since |
|---------|----------|-------|
| `sort.Slice` / `sort.Ints` | `slices.Sort` / `slices.SortFunc` | 1.21 |
| 手動スライス検索 | `slices.Contains` | 1.21 |
| 手動マップコピー | `maps.Copy` | 1.21 |
| 自前 `min`/`max` 関数 | ビルトイン `min()`/`max()` | 1.21 |
| `log.Printf` | `slog.Info` 等（構造化ログ） | 1.21 |
| `for i := 0; i < n; i++` | `for i := range n` | 1.22 |
| ループ変数 `v := v` | 不要（変数はイテレーション毎スコープ） | 1.22 |
| `for i := 0; i < b.N; i++` | `for b.Loop()` | 1.24 |

### 提案レベル

| 項目 | 内容 | Since |
|------|------|-------|
| `go fix ./...` | 古いパターンの自動修正 | 1.26 |
| `new(int, 42)` | 初期値付きnew | 1.26 |

## パフォーマンス

| 項目 | 推奨 |
|------|------|
| ポインタ vs 値 | 大きな構造体はポインタ |
| ゴルーチン | 適切なライフサイクル管理 |
| defer | 重いループ内では避ける |
| スライス事前割り当て | `make([]T, 0, capacity)` |

## 並行処理

| パターン | 使用ケース |
|----------|------------|
| **goroutine** | 軽量な並行処理 |
| **channel** | ゴルーチン間通信 |
| **sync.WaitGroup** | 複数ゴルーチン待機 |
| **context** | キャンセル・タイムアウト制御 |
