# Claude Code 実践Tips

## コンテキスト管理

| 項目 | 内容 |
|------|------|
| 監視 | statusLine の brain マーク = コンテキストサイズ |
| 圧縮閾値 | 80%超で auto compact 発動 → 品質劣化 |
| **鉄則** | **タスク終了後は再起動**（Ctrl-C 2回） |
| 確認 | `/context` で使用状況確認 |

### 圧縮対処

| ❌ 避ける | ✅ 推奨 |
|----------|---------|
| 圧縮頻発を放置 | auto-compact OFF → 手動 `/compact` |
| 圧縮後に何もしない | 圧縮後は `/reload` で CLAUDE.md 再読み込み |
| タスク終了後も閉じない | 一連タスク完了後に再起動 |

---

## サブエージェント

| 項目 | 内容 |
|------|------|
| 3層構造 | PO → Manager → Developer (1-4) |
| **使う** | 複数ファイル実装、並列処理、設計→実装→レビュー |
| **使わない** | 単一ファイル修正、シンプルなバグ修正 |

---

## よく使うコマンド

| コマンド | 用途 |
|----------|------|
| `/resume` | 過去セッション継続 |
| `/rename` | セッション名変更（引数なし→自動生成） |
| `/serena オンボーディング` | 新規プロジェクト初期化 |
| `/serena-refresh` | メモリ情報最新化 |
| `/reload` | compact 後のリカバリー |
| `/doctor` | 環境確認 |
| `/status` | 設定確認 |
| `/context` | コンテキストサイズ確認 |
| `claude auth login` | 認証ログイン（CLI） |
| `claude auth status` | 認証状態確認（CLI） |
| `claude auth logout` | 認証ログアウト（CLI） |

---

## ファイル参照機能（v2.1.41+）

| 記法 | 説明 |
|------|------|
| `@README.md` | ファイル全体を参照 |
| `@README.md#installation` | 特定セクションを参照（アンカーフラグメント） |

**用途**: 会話中に特定のドキュメントセクションを正確に参照したい時に便利

---

## トラブルシューティング

| 問題 | 対処 |
|------|------|
| 想定外の動作 | ESC で即停止 → 追加指示 |
| 圧縮頻発 | タスク終了後に再起動 |
| 認証エラー | `claude auth status` で確認 → `claude auth login` で再認証 |
| AWS認証ハング | v2.1.41で3分タイムアウト追加（自動復旧） |

---

## Git Worktree

複数 Claude Code で並行作業時に便利。シンプルなタスクは「worktree 不要、ブランチだけ切って」と指示。

---

## コスト管理

| 項目 | 内容 |
|------|------|
| 料金確認 | statusLine で料金確認 |
| MCP | 必要最小限に（コンテキスト大量消費） |
| Skill | 必要時のみ知識ロード |
| タスク分割 | 終わったら再起動 |
