openapi: 3.0.3
info:
  title: Claude Code Hooks & Agents API
  description: |
    Claude Code ã® Hooks ã¨ Agents ã® APIä»•æ§˜æ›¸ã€‚
    
    ## Hooks
    Claude Code ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã«å¿œç­”ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
    JSONå…¥åŠ›ã‚’å—ã‘å–ã‚Šã€JSONå‡ºåŠ›ã‚’è¿”ã™ã€‚
    
    ## Agents
    ã‚¿ã‚¹ã‚¯ã‚’è‡ªå¾‹çš„ã«å®Ÿè¡Œã™ã‚‹å°‚ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€‚
    Serena MCP ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ¼ãƒ‰æ“ä½œã‚’å®Ÿæ–½ã€‚
  version: 1.0.0
  contact:
    name: ai-tools
    url: https://github.com/yourusername/ai-tools

servers:
  - url: file://~/.claude/hooks
    description: Hookså®Ÿè¡Œç’°å¢ƒ
  - url: file://~/.claude/agents
    description: Agentså®Ÿè¡Œç’°å¢ƒ

paths:
  /hooks/session-start:
    post:
      summary: SessionStart Hook
      description: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯
      operationId: sessionStart
      tags:
        - Hooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SessionStartInput'
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookOutput'

  /hooks/user-prompt-submit:
    post:
      summary: UserPromptSubmit Hook
      description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé€ä¿¡æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ï¼ˆæŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è‡ªå‹•æ¤œå‡ºï¼‰
      operationId: userPromptSubmit
      tags:
        - Hooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPromptSubmitInput'
      responses:
        '200':
          description: æˆåŠŸï¼ˆæ¤œå‡ºçµæœã‚’è¿”ã™ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookOutput'
              examples:
                go-detected:
                  summary: Goè¨€èªæ¤œå‡º
                  value:
                    systemMessage: "ğŸ” Tech stack detected: golang | Skills: go-backend"
                    additionalContext: |
                      # Auto-Detected Configuration
                      
                      **Languages**: golang
                      **Skills**: go-backend
                      **Recommendation**: Run `/load-guidelines` to load Go-specific guidelines

  /hooks/pre-tool-use:
    post:
      summary: PreToolUse Hook
      description: ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç›´å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ï¼ˆå±é™ºæ“ä½œæ¤œå‡ºï¼‰
      operationId: preToolUse
      tags:
        - Hooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PreToolUseInput'
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookOutput'

  /hooks/pre-compact:
    post:
      summary: PreCompact Hook
      description: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåœ§ç¸®å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿å­˜ï¼‰
      operationId: preCompact
      tags:
        - Hooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PreCompactInput'
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookOutput'

  /hooks/session-end:
    post:
      summary: SessionEnd Hook
      description: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ï¼ˆçµ±è¨ˆãƒ­ã‚°ä¿å­˜ï¼‰
      operationId: sessionEnd
      tags:
        - Hooks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SessionEndInput'
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookOutput'

  /agents/workflow-orchestrator:
    post:
      summary: Workflow Orchestrator Agent
      description: ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’è‡ªå‹•åˆ¤å®šã—ã€æœ€é©ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ
      operationId: workflowOrchestrator
      tags:
        - Agents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentInput'
      responses:
        '200':
          description: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº†
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentOutput'

  /agents/verify-app:
    post:
      summary: Verify App Agent
      description: ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆãƒ»lintã‚’åŒ…æ‹¬çš„ã«æ¤œè¨¼
      operationId: verifyApp
      tags:
        - Agents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentInput'
      responses:
        '200':
          description: æ¤œè¨¼çµæœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyAppOutput'

  /agents/code-simplifier:
    post:
      summary: Code Simplifier Agent
      description: å®Ÿè£…å¾Œã®ã‚³ãƒ¼ãƒ‰ç°¡ç´ åŒ–ã‚’å®Ÿæ–½ï¼ˆè¤‡é›‘åº¦å‰Šæ¸›ãƒ»é‡è¤‡çµ±åˆï¼‰
      operationId: codeSimplifier
      tags:
        - Agents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentInput'
      responses:
        '200':
          description: ç°¡ç´ åŒ–å®Œäº†
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentOutput'

components:
  schemas:
    # Hook Input Schemas
    SessionStartInput:
      type: object
      properties:
        mcp_servers:
          type: object
          description: æœ‰åŠ¹ãªMCPã‚µãƒ¼ãƒãƒ¼ä¸€è¦§
          additionalProperties: true
        hook_event_name:
          type: string
          example: "SessionStart"

    UserPromptSubmitInput:
      type: object
      required:
        - prompt
      properties:
        prompt:
          type: string
          description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
          example: "Goè¨€èªã§REST APIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„"
        hook_event_name:
          type: string
          example: "UserPromptSubmit"

    PreToolUseInput:
      type: object
      required:
        - tool_name
        - tool_input
      properties:
        tool_name:
          type: string
          description: å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«å
          example: "Bash"
        tool_input:
          type: object
          description: ãƒ„ãƒ¼ãƒ«ã¸ã®å…¥åŠ›
          properties:
            command:
              type: string
              example: "npm run lint"
        hook_event_name:
          type: string
          example: "PreToolUse"

    PreCompactInput:
      type: object
      properties:
        session_id:
          type: string
          description: ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
        workspace:
          type: object
          properties:
            current_dir:
              type: string
              example: "/Users/daichi/ai-tools"
        current_tokens:
          type: integer
          description: ç¾åœ¨ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°
          example: 150000
        mcp_servers:
          type: object
          additionalProperties: true
        hook_event_name:
          type: string
          example: "PreCompact"

    SessionEndInput:
      type: object
      properties:
        session_id:
          type: string
        workspace:
          type: object
          properties:
            current_dir:
              type: string
        total_tokens:
          type: integer
          example: 50000
        total_messages:
          type: integer
          example: 25
        duration:
          type: integer
          description: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ï¼ˆç§’ï¼‰
          example: 1200
        hook_event_name:
          type: string
          example: "SessionEnd"

    # Hook Output Schema
    HookOutput:
      type: object
      properties:
        systemMessage:
          type: string
          description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
          example: "ğŸ” Tech stack detected: golang"
        additionalContext:
          type: string
          description: AIã«æ¸¡ã•ã‚Œã‚‹è¿½åŠ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
          example: "# Auto-Detected Configuration\n\n**Languages**: golang"
        error:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã®ã¿ï¼‰
          example: "jq not installed"

    # Agent Input/Output Schemas
    AgentInput:
      type: object
      required:
        - prompt
      properties:
        prompt:
          type: string
          description: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®ã‚¿ã‚¹ã‚¯æŒ‡ç¤º
          example: "ã‚¿ã‚¹ã‚¯: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’è¿½åŠ , ã‚¿ã‚¤ãƒ—: feature, è¤‡é›‘åº¦: TaskDecomposition"
        mode:
          type: string
          enum: [plan, default]
          description: å®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰
          default: default

    AgentOutput:
      type: object
      properties:
        status:
          type: string
          enum: [success, failure]
          description: å®Ÿè¡Œçµæœ
        summary:
          type: string
          description: å®Ÿè¡Œã‚µãƒãƒªãƒ¼
        files_created:
          type: array
          items:
            type: string
          description: ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
        files_modified:
          type: array
          items:
            type: string
          description: å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

    VerifyAppOutput:
      allOf:
        - $ref: '#/components/schemas/AgentOutput'
        - type: object
          properties:
            lint_result:
              type: object
              properties:
                passed:
                  type: boolean
                errors:
                  type: integer
                warnings:
                  type: integer
            test_result:
              type: object
              properties:
                passed:
                  type: boolean
                total:
                  type: integer
                success:
                  type: integer
                failed:
                  type: integer
            build_result:
              type: object
              properties:
                passed:
                  type: boolean
                message:
                  type: string

tags:
  - name: Hooks
    description: Claude Code ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯
  - name: Agents
    description: è‡ªå¾‹å®Ÿè¡Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
