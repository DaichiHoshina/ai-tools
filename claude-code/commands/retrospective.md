---
allowed-tools: Read, Glob, Grep, Bash, mcp__serena__list_memories, mcp__serena__read_memory, mcp__serena__write_memory
description: 振り返り - 過去のセッションを分析し、スキル・設定の改善案を提案
---

# /retrospective - 振り返り・自己改善コマンド

## 目的

過去のセッション履歴・作業記録を分析し、スキルや設定の改善案を自動生成する。

## 実行フロー

### Phase 1: データ収集

以下のソースから情報を収集:

```bash
# セッション履歴（直近100件）
~/.claude/history.jsonl

# 過去のTODO
~/.claude/todos/

# Serena memory
mcp__serena__list_memories → 各memoryを読み込み
```

### Phase 2: パターン分析

収集したデータから以下を抽出:

#### 2.1 失敗パターン
- エラーが頻発したタスク
- 何度もリトライしたコマンド
- 中断されたタスク

#### 2.2 非効率パターン
- 同じ質問が繰り返されている
- 毎回同じ設定を説明している
- 手動で繰り返している作業

#### 2.3 成功パターン
- うまくいったワークフロー
- 効率的だったアプローチ
- ユーザーが満足した対応

### Phase 3: 改善案生成

分析結果から以下を提案:

```markdown
## 改善案

### 新スキル提案
- [提案1] 〇〇スキルの作成
  - 理由: △△のパターンが頻出
  - 効果: 毎回の説明が不要に

### 既存スキル改善
- [改善1] □□スキルに◇◇を追加
  - 理由: 関連質問が多い
  - 変更案: ...

### CLAUDE.md追記案
- [追記1] 「〇〇の場合は△△する」を追加
  - 理由: 毎回確認している

### 自動化提案
- [Hook] 〇〇時に△△を自動実行
  - 理由: 手動で毎回やっている
```

### Phase 4: 採用・反映

```
AskUserQuestion:
- どの改善案を採用しますか？（複数選択可）

採用された案を実行:
- 新スキル → skills/ に作成
- 改善 → 該当ファイルを編集
- CLAUDE.md → 追記
- memory → 保存
```

## 出力フォーマット

```markdown
# Retrospective Report

## 分析期間
YYYY-MM-DD 〜 YYYY-MM-DD（直近N件）

## 発見したパターン

### ❌ 問題パターン
1. [頻度: 高] 〇〇で毎回つまずいている
2. [頻度: 中] △△の説明を繰り返している

### ✅ 成功パターン
1. □□のアプローチが効率的だった
2. ◇◇のワークフローがスムーズだった

## 改善提案

### 🆕 新スキル
| 名前 | 理由 | 優先度 |
|------|------|--------|
| ... | ... | 高/中/低 |

### 🔧 既存改善
| 対象 | 変更内容 | 優先度 |
|------|---------|--------|
| ... | ... | 高/中/低 |

### ⚙️ 自動化
| トリガー | アクション | 優先度 |
|---------|-----------|--------|
| ... | ... | 高/中/低 |

## 次のアクション
- [ ] 採用する改善を選択
- [ ] 実装を実行
```

## 定期実行の推奨

週1回程度の実行を推奨:
```
毎週金曜 → /retrospective
→ 改善案を検討
→ 採用分を反映
→ 翌週に効果確認
```

## 注意事項

- 履歴にはセンシティブな情報が含まれる可能性あり
- 分析結果は外部に送信しない
- 改善は必ずユーザー承認を得てから実行
